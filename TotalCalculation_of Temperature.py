# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# TotalCalculation_of Temperature.py
# Created on: 2024-01-03 19:27:02.00000
#   (generated by ArcGIS/ModelBuilder)
# Usage: TotalCalculation_of Temperature <v1993_band6> <v2008_ban6> <v2023_band10> <v2023_band4> <v2023_band5> <Point_of_lakes_shp> <Table_test_xls> <v1993_temperature> <v2008_Temperature> <v2023_temperature> 
# Description: 
# ---------------------------------------------------------------------------

# Import arcpy module
import arcpy

# Check out any necessary licenses
arcpy.CheckOutExtension("spatial")

# Script arguments
v1993_band6 = arcpy.GetParameterAsText(0)
if v1993_band6 == '#' or not v1993_band6:
    v1993_band6 = "F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Temperature\\Narayani Basin\\1993\\LT05_L1TP_142040_19931017_20200913_02_T1_B6.TIF" # provide a default value if unspecified

v2008_ban6 = arcpy.GetParameterAsText(1)
if v2008_ban6 == '#' or not v2008_ban6:
    v2008_ban6 = "F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Temperature\\Narayani Basin\\2008\\LT05_L1TP_142040_20081026_20200828_02_T1_B6.TIF" # provide a default value if unspecified

v2023_band10 = arcpy.GetParameterAsText(2)
if v2023_band10 == '#' or not v2023_band10:
    v2023_band10 = "F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Temperature\\Narayani Basin\\2023\\LC09_L1TP_142040_20231012_20231012_02_T1_B10.TIF" # provide a default value if unspecified

v2023_band4 = arcpy.GetParameterAsText(3)
if v2023_band4 == '#' or not v2023_band4:
    v2023_band4 = "F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Temperature\\Narayani Basin\\2023\\LC09_L1TP_142040_20231012_20231012_02_T1_B4.TIF" # provide a default value if unspecified

v2023_band5 = arcpy.GetParameterAsText(4)
if v2023_band5 == '#' or not v2023_band5:
    v2023_band5 = "F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Temperature\\Narayani Basin\\2023\\LC09_L1TP_142040_20231012_20231012_02_T1_B5.TIF" # provide a default value if unspecified

Point_of_lakes_shp = arcpy.GetParameterAsText(5)
if Point_of_lakes_shp == '#' or not Point_of_lakes_shp:
    Point_of_lakes_shp = "F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Shape_files\\Point_of_lakes.shp" # provide a default value if unspecified

Table_test_xls = arcpy.GetParameterAsText(6)
if Table_test_xls == '#' or not Table_test_xls:
    Table_test_xls = "F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Temperature_calculation\\Table_test.xls" # provide a default value if unspecified

v1993_temperature = arcpy.GetParameterAsText(7)
if v1993_temperature == '#' or not v1993_temperature:
    v1993_temperature = "F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Temperature_calculation\\1993_temperature.tif" # provide a default value if unspecified

v2008_Temperature = arcpy.GetParameterAsText(8)
if v2008_Temperature == '#' or not v2008_Temperature:
    v2008_Temperature = "F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Temperature_calculation\\2008_Temperature.tif" # provide a default value if unspecified

v2023_temperature = arcpy.GetParameterAsText(9)
if v2023_temperature == '#' or not v2023_temperature:
    v2023_temperature = "F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Temperature_calculation\\2023_temperature.tif" # provide a default value if unspecified

# Local variables:
v1993_tif = v1993_band6
Kelvin_tif = v1993_tif
v1993_extract_shp = v1993_temperature
Extract_oints_shp__2_ = v1993_extract_shp
v1993_extract = Extract_oints_shp__2_
Merge_check2_shp = v1993_extract
Ra1_tif = v2008_ban6
Kelvin_1_tif = Ra1_tif
v2008_extract_shp = v2008_Temperature
Extract_oints_shp__5_ = v2008_extract_shp
v2008_extract = Extract_oints_shp__5_
TOA1_tif = v2023_band10
BT1_tif = TOA1_tif
NDVI1_tif = v2023_band4
Property = NDVI1_tif
PVI1_tif = Property
Emissivity_tif = PVI1_tif
Property__2_ = NDVI1_tif
v2023_extract_shp = v2023_temperature
Extract_oints_shp__8_ = v2023_extract_shp
v2023_extract = Extract_oints_shp__8_

# Process: Raster Calculator
arcpy.gp.RasterCalculator_sa("(15.303 - 1.238) / (255 - 1) * (\"%1993_band6%\" - 1) + 1.238", v1993_tif)

# Process: Raster Calculator (2)
arcpy.gp.RasterCalculator_sa("1260.56/Ln(607.76/\"%1993.tif%\"+1)", Kelvin_tif)

# Process: Raster Calculator (3)
arcpy.gp.RasterCalculator_sa("\"%Kelvin.tif%\"-273.15", v1993_temperature)

# Process: Extract Values to Points
arcpy.gp.ExtractValuesToPoints_sa(Point_of_lakes_shp, v1993_temperature, v1993_extract_shp, "INTERPOLATE", "VALUE_ONLY")

# Process: Add Field
arcpy.AddField_management(v1993_extract_shp, "Year", "TEXT", "", "", "4", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field
arcpy.CalculateField_management(Extract_oints_shp__2_, "Year", "1992+1", "VB", "")

# Process: Raster Calculator (4)
arcpy.gp.RasterCalculator_sa("(15.303 - 1.238) / (255 - 1) * (\"%2008_ban6%\" - 1) + 1.238", Ra1_tif)

# Process: Raster Calculator (5)
arcpy.gp.RasterCalculator_sa("1260.56/Ln(607.76/\"%Ra1.tif%\"+1)", Kelvin_1_tif)

# Process: Raster Calculator (6)
arcpy.gp.RasterCalculator_sa("\"%Kelvin_1.tif%\"-273.15", v2008_Temperature)

# Process: Extract Values to Points (2)
arcpy.gp.ExtractValuesToPoints_sa(Point_of_lakes_shp, v2008_Temperature, v2008_extract_shp, "NONE", "VALUE_ONLY")

# Process: Add Field (2)
arcpy.AddField_management(v2008_extract_shp, "Year", "TEXT", "", "", "4", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field (2)
arcpy.CalculateField_management(Extract_oints_shp__5_, "Year", "2007+1", "VB", "")

# Process: Raster Calculator (7)
arcpy.gp.RasterCalculator_sa("0.00038 * (\"%2023_band10%\"- 1) + 0.1000", TOA1_tif)

# Process: Raster Calculator (8)
arcpy.gp.RasterCalculator_sa("1321.0789/Ln((799.0284/\"%TOA1.tif%\")+1)-273.15", BT1_tif)

# Process: Raster Calculator (9)
arcpy.gp.RasterCalculator_sa("Float(\"%2023_band5%\"-\"%2023_band4%\")/Float(\"%2023_band5%\"+\"%2023_band4%\")", NDVI1_tif)

# Process: Get Raster Properties (2)
arcpy.GetRasterProperties_management(NDVI1_tif, "MINIMUM", "")

# Process: Get Raster Properties
arcpy.GetRasterProperties_management(NDVI1_tif, "MAXIMUM", "")

# Process: Raster Calculator (12)
arcpy.gp.RasterCalculator_sa("Square(\"%NDVI1.tif%\"-float(%Property (2)%))/float(%Property%)-float(%Property (2)%)", PVI1_tif)

# Process: Raster Calculator (10)
arcpy.gp.RasterCalculator_sa("0.004*\"%PVI1.tif%\"+0.986", Emissivity_tif)

# Process: Raster Calculator (11)
arcpy.gp.RasterCalculator_sa("\"%BT1.tif%\"/1+(0.00115*\"%BT1.tif%\"/1.4388)*Ln(\"%Emissivity.tif%\")", v2023_temperature)

# Process: Extract Values to Points (3)
arcpy.gp.ExtractValuesToPoints_sa(Point_of_lakes_shp, v2023_temperature, v2023_extract_shp, "NONE", "VALUE_ONLY")

# Process: Add Field (3)
arcpy.AddField_management(v2023_extract_shp, "Year", "TEXT", "", "", "4", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field (3)
arcpy.CalculateField_management(Extract_oints_shp__8_, "Year", "2022+1", "VB", "")

# Process: Merge
arcpy.Merge_management("F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp;F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp;F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp", Merge_check2_shp, "OID_ \"OID_\" true true false 10 Long 0 10 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,OID_,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,OID_,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,OID_,-1,-1;Name \"Name\" true true false 254 Text 0 0 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,Name,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,Name,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,Name,-1,-1;FolderPath \"FolderPath\" true true false 254 Text 0 0 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,FolderPath,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,FolderPath,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,FolderPath,-1,-1;SymbolID \"SymbolID\" true true false 10 Long 0 10 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,SymbolID,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,SymbolID,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,SymbolID,-1,-1;AltMode \"AltMode\" true true false 5 Short 0 5 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,AltMode,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,AltMode,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,AltMode,-1,-1;Base \"Base\" true true false 19 Double 0 0 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,Base,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,Base,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,Base,-1,-1;Snippet \"Snippet\" true true false 254 Text 0 0 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,Snippet,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,Snippet,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,Snippet,-1,-1;PopupInfo \"PopupInfo\" true true false 254 Text 0 0 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,PopupInfo,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,PopupInfo,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,PopupInfo,-1,-1;HasLabel \"HasLabel\" true true false 5 Short 0 5 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,HasLabel,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,HasLabel,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,HasLabel,-1,-1;LabelID \"LabelID\" true true false 10 Long 0 10 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,LabelID,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,LabelID,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,LabelID,-1,-1;RASTERVALU \"RASTERVALU\" true true false 19 Double 0 0 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,RASTERVALU,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,RASTERVALU,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,RASTERVALU,-1,-1;Year \"Year\" true true false 4 Text 0 0 ,First,#,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\1993_extract.shp,Year,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2008_extract.shp,Year,-1,-1,F:\\Master_in_Geography\\Fourth_Semsester\\Seminar\\Data\\Satellite_images\\Calculated_Images\\Other_calculation\\2023_extract.shp,Year,-1,-1")

# Process: Table To Excel
arcpy.TableToExcel_conversion(Merge_check2_shp, Table_test_xls, "NAME", "CODE")

